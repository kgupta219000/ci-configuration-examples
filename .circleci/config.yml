version: 2.1
orbs:
  matlab: mathworks/matlab@0
jobs:
  build:
    machine:
      image: ubuntu-2004:202201-02
      
    working_directory: /tmp
    steps:
      - checkout
      
      - run:
          name: Creating Dummy Artifacts
          command: |
            echo "my artifact file" > /tmp/art-1;
            mkdir /tmp/artifacts;
            echo "my artifact files in a dir" > /tmp/artifacts/art-2;

      #- store_artifacts:
      #    path: /tmp/art-1
      #    destination: artifact-file

      #- store_artifacts:
      #    path: /tmp/artifacts

      - matlab/install
      - matlab/run-tests:
          source-folder: code
          test-results-junit: /.tmp/test-results/results.xml
      - store_test_results:
          path: /.tmp/test-results

      # As an alternative to run-tests, you can use run-command to execute a MATLAB script, function, or statement.
      # - matlab/run-command:
      #     command: addpath('code'); results = runtests('IncludeSubfolders', true); assertSuccess(results);
