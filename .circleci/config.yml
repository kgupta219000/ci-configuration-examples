version: 2.1
orbs:
  matlab: mathworks/matlab@0
jobs:
  build:
    machine:
      image: ubuntu-2004:202201-02
      
    steps:
      - checkout
      - matlab/install
      
      - matlab/run-command:
          command: HelloWorld
          
      - matlab/run-tests:
          source-folder: code
          test-results-junit: test-results/matlab/results.xml
          code-coverage-cobertura: code-coverage/matlab/codeCoverage.xml
      - store_test_results:
          path: test-results
      #- store_code_coverage:
          #path: code-coverage
      - store_artifacts:
          path: test-results
          destination: test-results
      - store_artifacts:
          path: code-coverage
          destination: code-coverage

      # As an alternative to run-tests, you can use run-command to execute a MATLAB script, function, or statement.
      # - matlab/run-command:
      #     command: addpath('code'); results = runtests('IncludeSubfolders', true); assertSuccess(results);
