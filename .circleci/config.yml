version: 2.1
orbs:
  matlab: mathworks/matlab@0
jobs:
  build:
    machine:
      image: ubuntu-2004:202201-02
      
    #working_directory: /tmp
    steps:
      - checkout
      
      #- run:
       #   name: Creating Dummy Artifacts
        #  command: |
         #   mkdir /test-results;

      #- store_artifacts:
      #    path: /tmp/art-1
      #    destination: artifact-file

      #- store_artifacts:
      #    path: /tmp/artifacts

      - matlab/install
      - matlab/run-tests:
          source-folder: code
          test-results-junit: test-results/matlab/results.xml
      - store_artifacts:
          path: test-results
          destination: artifact-file

      # As an alternative to run-tests, you can use run-command to execute a MATLAB script, function, or statement.
      # - matlab/run-command:
      #     command: addpath('code'); results = runtests('IncludeSubfolders', true); assertSuccess(results);
